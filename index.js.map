{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst gallery = document.querySelector('.gallery');\n\n// Инициализация SimpleLightbox для модального окна с изображениями\nlet lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',  // Для отображения подписи\n  captionDelay: 250,    // Задержка при отображении подписи\n});\n\n// Функция для рендеринга изображений\nexport function renderImages(images, append = false) {\n  if (!images || images.length === 0) {\n    // Показать сообщение об ошибке, если не было найдено изображений\n    showErrorMessage('Sorry, no images match your search. Please try again!');\n    return;\n  }\n\n  // Создание разметки для изображений\n  const markup = images.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads, id }) => `\n    <div class=\"gallery-item\" data-id=\"${id}\">\n      <a href=\"${largeImageURL}\">\n        <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n      </a>\n      <div class=\"image-info\">\n        <div class=\"item\"><span class=\"label\">Likes</span><span class=\"count\">${likes}</span></div>\n        <div class=\"item\"><span class=\"label\">Views</span><span class=\"count\">${views}</span></div>\n        <div class=\"item\"><span class=\"label\">Comments</span><span class=\"count\">${comments}</span></div>\n        <div class=\"item\"><span class=\"label\">Downloads</span><span class=\"count\">${downloads}</span></div>\n      </div>\n    </div>\n  `).join('');\n\n  // Если добавляем новые изображения, то не очищаем галерею\n  if (!append) {\n    gallery.innerHTML = '';  // Очистка галереи перед рендером\n  }\n\n  // Добавление разметки в галерею\n  gallery.insertAdjacentHTML('beforeend', markup);\n\n  // Обновляем SimpleLightbox для новых изображений\n  lightbox.refresh();\n\n  // Плавная прокрутка\n  smoothScroll();\n}\n\n// Функция для плавной прокрутки\nfunction smoothScroll() {\n  const firstGalleryItem = document.querySelector('.gallery-item');\n  if (firstGalleryItem) {\n    const cardHeight = firstGalleryItem.getBoundingClientRect().height;\n    window.scrollBy({ top: cardHeight * 2, behavior: 'smooth' });\n  }\n}\n\n// Функция для отображения сообщения об ошибке\nfunction showErrorMessage(message) {\n  iziToast.error({\n    title: 'Error',\n    message: message,\n    position: 'topRight',\n  });\n}\n\n// Функция для отображения сообщения о конце коллекции\nexport function showEndMessage() {\n  const message = document.createElement('p');\n  message.classList.add('end-message');\n  message.textContent = \"We're sorry, but you've reached the end of search results.\";\n  gallery.after(message);\n}\n\n// Функция для скрытия кнопки \"Load More\"\nexport function hideLoadMoreButton() {\n  const loadMoreButton = document.querySelector('.load-more');\n  if (loadMoreButton) {\n    loadMoreButton.style.display = 'none';\n  }\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","import { renderImages, showEndMessage, hideLoadMoreButton } from './js/render-functions.js';  // Импорт нужных функций\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport './css/styles.css';  // Импорт стилей для лоадера\n\nconst form = document.querySelector('.search-form');\nconst loadMoreButton = document.querySelector('.load-more');\n\nlet searchQuery = '';\nlet currentPage = 1;\nconst perPage = 40;\nlet totalHits = 0;\nlet loadedImages = new Set(); // Для хранения уникальных изображений (по ID)\n\nfunction showLoader() {\n  document.getElementById('loading-overlay').style.display = 'flex';\n}\n\nfunction hideLoader() {\n  document.getElementById('loading-overlay').style.display = 'none';\n}\n\n// Функция для отправки запроса и обработки данных\nasync function loadImages(query, page) {\n  // Проверка на пустой запрос\n  if (!query || query.trim() === '') {\n    iziToast.warning({\n      title: 'Warning',\n      message: 'Please enter a valid search term!',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  showLoader();\n\n  try {\n    const response = await fetchImages(query, page, perPage);\n\n    if (!response || !response.hits || response.hits.length === 0) {\n      iziToast.error({\n        title: 'Error',\n        message: 'Sorry, no images match your search. Please try again!',\n        position: 'topRight',\n      });\n      return;\n    }\n\n    // Обновляем количество найденных изображений\n    totalHits = Math.min(response.totalHits, 500);\n\n    // Отфильтровываем изображения, чтобы избежать повторений\n    const newImages = response.hits.filter(image => !loadedImages.has(image.id));\n\n    if (newImages.length > 0) {\n      renderImages(newImages, currentPage > 1);\n      newImages.forEach(image => loadedImages.add(image.id)); // Добавляем в Set уникальные ID\n    }\n\n    // Если количество всех найденных изображений больше, чем одно подгружаем следующее\n    if (totalHits <= currentPage * perPage) {\n      hideLoadMoreButton(); // Скрыть кнопку \"Load More\"\n      showEndMessage(); // Показать сообщение о конце коллекции\n    } else {\n      loadMoreButton.style.display = 'block'; // Показать кнопку \"Load More\"\n    }\n\n    smoothScroll(); // Плавная прокрутка\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Failed to load images. Please try again.',\n      position: 'topRight',\n    });\n  } finally {\n    hideLoader();\n  }\n}\n\n// Плавная прокрутка\nfunction smoothScroll() {\n  const firstGalleryItem = document.querySelector('.gallery-item');\n  if (firstGalleryItem) {\n    const cardHeight = firstGalleryItem.getBoundingClientRect().height;\n    window.scrollBy({ top: cardHeight * 2, behavior: 'smooth' });\n  }\n}\n\n// Обработчик отправки формы\nform.addEventListener('submit', async event => {\n  event.preventDefault();\n\n  searchQuery = event.target.elements.searchQuery.value.trim();\n\n  // Проверка на пустой запрос\n  if (!searchQuery || searchQuery.trim() === '') {\n    iziToast.warning({\n      title: 'Warning',\n      message: 'Please enter a valid search term!',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  currentPage = 1;\n  totalHits = 0;\n  loadedImages.clear(); // Очистка Set с загруженными изображениями\n  hideLoadMoreButton(); // Скрыть кнопку \"Load More\"\n  showLoader();\n\n  try {\n    const response = await fetchImages(searchQuery, currentPage, perPage);\n\n    if (response && response.hits.length > 0) {\n      renderImages(response.hits);\n      totalHits = response.totalHits;\n\n      // Если есть больше изображений, показываем кнопку \"Load More\"\n      if (totalHits > perPage) {\n        loadMoreButton.style.display = 'block';\n      } else {\n        showEndMessage(); // Показать сообщение о конце коллекции, если изображений больше нет\n      }\n    } else {\n      iziToast.error({\n        title: 'Error',\n        message: 'Sorry, no images match your search. Please try again!',\n        position: 'topRight',\n      });\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Failed to load images. Please try again.',\n      position: 'topRight',\n    });\n  } finally {\n    hideLoader();\n  }\n});\n\n// Обработчик кнопки \"Load More\"\nloadMoreButton.addEventListener('click', async () => {\n  currentPage += 1;\n  showLoader();\n\n  try {\n    const response = await fetchImages(searchQuery, currentPage, perPage);\n\n    if (response && response.hits.length > 0) {\n      // Отфильтровываем изображения, чтобы избежать повторений\n      const newImages = response.hits.filter(image => !loadedImages.has(image.id));\n      renderImages(newImages, true); // Рендерим изображения без очистки галереи\n      newImages.forEach(image => loadedImages.add(image.id)); // Добавляем новые изображения в Set\n\n      // Если достигнут конец коллекции\n      if (currentPage * perPage >= totalHits) {\n        hideLoadMoreButton(); // Скрыть кнопку \"Load More\"\n        showEndMessage(); // Показать сообщение о конце коллекции\n      }\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Failed to load more images. Please try again.',\n      position: 'topRight',\n    });\n  } finally {\n    hideLoader();\n  }\n});\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"],"names":["gallery","lightbox","SimpleLightbox","renderImages","images","append","showErrorMessage","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","id","smoothScroll","firstGalleryItem","cardHeight","message","showEndMessage","hideLoadMoreButton","loadMoreButton","form","searchQuery","currentPage","perPage","totalHits","loadedImages","showLoader","hideLoader","event","iziToast","response","newImages","image"],"mappings":"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"}